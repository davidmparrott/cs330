
void solve( int N,  double **A, double b[], double x[]){
  for (int i = 0; i < N; i++) 
    for ( int j = i + 1; j < N; j++){
      const double s = -A[j][i]/A[i][i];
      for( int K = 0; k < N; k++)
	A[j][k] += s*A[i][k];
      b[j] += s*b[i];     
    }
  x[N-1] = b[N-1]/A[N-1][N-1];
  for (int i = N - 2; i >= 0; --i){
    double sum = 0.0;
    for (int j = i + 1; j < N; j++)
      sum += A[i][j]*x[j];
    x[i] = (b[i] - sum)/A[i][i];
  }
}
